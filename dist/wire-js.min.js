var WireJs=function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=n(e);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c={name:"WireLink",functional:!0,props:{href:{type:String,required:!0},method:{type:String,default:"get"},replace:{type:Boolean,default:!1},preserveScroll:{type:Boolean,default:!1},as:{type:String,default:"a"}},render:function(t,e){var n=e.props,o=e.data,i=e.children;return t(n.as,d(d({},o),{},{attrs:d(d({},o.attrs),{},{href:n.href}),on:d(d({},o.on||{}),{},{click:function(t){t.preventDefault(),e.parent.$store.state.ternoboWireApp.visit(n.href,{method:n.method})}})}),i)}};function u(t,e,n,o,i,a,r,s,d,c){"boolean"!=typeof r&&(d=s,s=r,r=!1);const u="function"==typeof n?n.options:n;let p;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),o&&(u._scopeId=o),a?(p=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,d(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},u._ssrRegister=p):e&&(p=r?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),p)if(u.functional){const t=u.render;u.render=function(e,n){return p.call(n),t(e,n)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,p):[p]}return n}var p=u({render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"app"}},[this._t("default")],2)},staticRenderFns:[]},void 0,{name:"AppLayout"},void 0,!1,void 0,!1,void 0,void 0,void 0),l=u({render:function(){var t=this.$createElement,e=this._self._c||t;return this.ready?e(this.layout,{tag:"component"},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[e(this.componentInstance,this._b({tag:"component"},"component",this.propsToBind,!1))],1)],1):this._e()},staticRenderFns:[]},void 0,{methods:{updateComponent:function(){var t=this;console.log(this.component),this.resolveComponent(this.component).then((function(e){t.componentInstance=e.default,null!=t.componentInstance.layout&&(t.layout=t.componentInstance.layout),t.componentInstance.props&&(t.propsToBind={},Array.isArray(t.componentInstance.props)?t.componentInstance.props.forEach((function(e){t.propsToBind[e]=t.data[e]})):Object.keys(t.componentInstance.props).forEach((function(e){t.propsToBind[e]=t.data[e]}))),t.$forceUpdate(),t.ready=!0}))}},data:function(){return{propsToBind:{},component:null,componentInstance:null,layout:p,ready:!1,data:{}}},created:function(){var t=this;this.data=this.initialData.data,this.component=this.initialComponent,this.$store.commit("userUpdate"),this.$store.commit("setupApp",{data:this.data,app:this}),this.$store.commit("updatedShared",this.initialData.shared),this.$nextTick((function(){t.updateComponent()}))},props:["initialData","resolveComponent","initialComponent"]},void 0,!1,void 0,!1,void 0,void 0,void 0);function f(t){var e=window.location,n=document.createElement("a");return n.href=t,n.hostname==e.hostname&&n.port==e.port&&n.protocol==e.protocol}var h=function(){function t(e,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.app=e,this.data=n,window.history.replaceState({visitId:"wire"},"",window.location.href),window.addEventListener("popstate",(function(t){JSON.stringify(window.history.state)==JSON.stringify(o.createVisitId())&&o.visit(window.location.href,{},"get",!1)}))}var e,n,o;return e=t,(n=[{key:"getData",value:function(e){var n=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"get",r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return new Promise((function(s,d){var c=new CustomEvent("ternobo:navigate",{detail:{location:e}});o&&window.document.dispatchEvent(c),axios({method:a,data:i,url:e,headers:{"X-TernoboWire":!0}}).then((function(t){if(s(t.data.data),t.headers["x-ternobowire"]){r&&window.history.pushState(n.createVisitId(),"",e);var i=new CustomEvent("ternobo:loaded",{detail:{location:e}});o&&window.document.dispatchEvent(i)}})).catch((function(e){t.production||console.log(e),d(e)})).then((function(){if(o){var t=new CustomEvent("ternobo:finish",{detail:{location:e}});window.document.dispatchEvent(t)}s()}))}))}},{key:"reload",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=window.href,i=new CustomEvent("ternobo:navigate",{detail:{location:o}});window.document.dispatchEvent(i),axios({method:type,data:{options:n},url:o,headers:{"X-TernoboWire":!0}}).then((function(t){if(t.headers["x-ternobowire"]){e.app.$store.commit("updatedShared",t.data.shared),e.loadComponent(t.data.component,t.data.data);var n=new CustomEvent("ternobo:loaded",{detail:{location:o}});window.document.dispatchEvent(n)}else window.location.reload()})).catch((function(e){t.production||console.log(e)})).then((function(){var t=new CustomEvent("ternobo:finish",{detail:{location:o}});window.document.dispatchEvent(t)}))}},{key:"visit",value:function(e){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];f(e)||window.open(e);var r=new CustomEvent("ternobo:navigate",{detail:{location:e}});window.document.dispatchEvent(r),axios({method:i,data:o,url:e,headers:{"X-TernoboWire":!0}}).then((function(t){if(t.headers["x-ternobowire"]){n.app.$store.commit("updatedShared",t.data.shared),n.loadComponent(t.data.component,t.data.data),a&&window.history.pushState(n.createVisitId(),"",e);var o=new CustomEvent("ternobo:loaded",{detail:{location:e}});window.document.dispatchEvent(o)}else window.location=e})).catch((function(e){t.production||console.log(e)})).then((function(){var t=new CustomEvent("ternobo:finish",{detail:{location:e}});window.document.dispatchEvent(t)}))}},{key:"loadComponent",value:function(t,e){this.app.component=t,this.app.data=e,this.app.updateComponent()}},{key:"createVisitId",value:function(){return this.visitId={visitId:"wire"},this.visitId}}])&&a(e.prototype,n),o&&a(e,o),t}(),v={install:function(t){t.use(o.default),t.component("wire-link",c),t.directive("infinite-scroll",{bind:function(t,e,n){t.addEventListener("scroll",(function(n){t.scrollTop+t.clientHeight>=t.scrollHeight&&e.value()}))}}),t.directive("click-outside",{bind:function(t,e,n){document.body.addEventListener("click",(function(t){return n.context.$emit(e.expression,t)}))}})}};return t.default=l,t.plugin=v,t.store=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{state:null,getters:{},mutations:null};return null!=t.state&&"object"==i(t.state)?(t.state.user=null,t.state.ternoboWireApp=null,t.state.shared={}):t.state={user:{},ternoboWireApp:null,shared:{}},null!=t.mutations&&"object"==i(t.mutations)?(t.mutations.setupApp=function(t,e){t.ternoboWireApp=new h(e.app,e.data)},t.mutations.updatedShared=function(t,e){t.shared=e},t.mutations.userUpdate=function(t){axios.post("/ternobo-wire/get-user").then((function(e){t.user=e.data.user}))}):t.mutations={updatedShared:function(t,e){t.shared=e},userUpdate:function(t){axios.post("/ternobo-wire/get-user").then((function(e){t.user=e.data.user}))},setupApp:function(t,e){t.ternoboWireApp=new h(e.app,e.data)}},new o.default.Store(t)},Object.defineProperty(t,"__esModule",{value:!0}),t}({},Vuex);