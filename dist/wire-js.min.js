var WireJs=function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={name:"WireLink",functional:!0,props:{href:{type:String,required:!0},method:{type:String,default:"get"},replace:{type:Boolean,default:!1},preserveScroll:{type:Boolean,default:!1},as:{type:String,default:"a"}},render:function(e,t){var n=t.props,o=t.data,a=t.children,i=n.data?n.data:{};return e(n.as,d(d({},o),{},{attrs:d(d({},o.attrs),{},{href:n.href}),on:d(d({},o.on||{}),{},{click:function(e){e.preventDefault(),t.parent.$store.state.ternoboWireApp.visit(n.href,i,n.method)}})}),a)}};function l(e,t,n,o,a,i,r,s,d,c){"boolean"!=typeof r&&(d=s,s=r,r=!1);const l="function"==typeof n?n.options:n;let u;if(e&&e.render&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,a&&(l.functional=!0)),o&&(l._scopeId=o),i?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},l._ssrRegister=u):t&&(u=r?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),u)if(l.functional){const e=l.render;l.render=function(t,n){return u.call(n),e(t,n)}}else{const e=l.beforeCreate;l.beforeCreate=e?[].concat(e,u):[u]}return n}const u="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function p(e){return(e,t)=>function(e,t){const n=u?t.media||"default":e,o=f[n]||(f[n]={ids:new Set,styles:[]});if(!o.ids.has(e)){o.ids.add(e);let n=t.source;if(t.map&&(n+="\n/*# sourceURL="+t.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),void 0===h&&(h=document.head||document.getElementsByTagName("head")[0]),h.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(n),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{const e=o.ids.size-1,t=document.createTextNode(n),a=o.element.childNodes;a[e]&&o.element.removeChild(a[e]),a.length?o.element.insertBefore(t,a[e]):o.element.appendChild(t)}}}(e,t)}let h;const f={};var m=l({render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:{"ternobo-loading":this.loading},attrs:{id:"app"}},[this.loading?t("svg",{staticStyle:{height:"64px",width:"64px"},attrs:{version:"1",xmlns:"http://www.w3.org/2000/svg",width:"682.667",height:"682.667",viewBox:"0 0 512.000000 512.000000"}},[t("path",{staticStyle:{fill:"#757575"},attrs:{d:"M106.3 164.8l.3 89.7 2.6 10.6c3.3 13.5 9.5 29.8 15.2 40.2 17.1 31.5 45.8 57.5 78.5 71.2 8.6 3.6 21.6 7.8 28.5 9l3.6.7V277h-65v-2.3c0-1.2.6-4.5 1.4-7.2 3.9-14.8 13.9-25.6 28-30.5 4.9-1.7 8.4-2 20.9-2h15l-.6-12.5c-2-39.7-17.4-74.3-45.7-102.6-21.9-22-48.3-36.9-76.8-43.3l-6.3-1.4.4 89.6zM395.2 128.6c-21.8 6.4-38.3 14.6-55.4 27.4-18 13.5-33.5 31.7-43.7 51.1-5.2 9.9-11.1 23.9-11.1 26.4 0 1.3 4.1 1.5 28.6 1.5h28.6l-.7 4.7c-2.2 15-12.2 28.3-25.6 34.2-6.1 2.7-15.5 4.1-28.1 4.1H277v158.9l3.3-.6c23.8-4.5 52.5-19.1 73.3-37.2 25.6-22.2 44.6-56.5 50.5-90.9 1.8-10.7 1.9-16.8 1.9-96.8 0-67.7-.3-85.4-1.2-85.3-.7 0-5 1.1-9.6 2.5z"}})]):this._t("default")],2)},staticRenderFns:[]},(function(e){e&&e("data-v-37504ae2_0",{source:".ternobo-loading[data-v-37504ae2]{display:flex;height:100vh;width:100vh;justify-content:center;align-items:center}",map:void 0,media:void 0})}),{name:"AppLayout",props:["loading"]},"data-v-37504ae2",!1,void 0,!1,p,void 0,void 0),v=l({render:function(){var e=this.$createElement,t=this._self._c||e;return t(this.layout,{tag:"component",attrs:{loading:this.loading}},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[this.ready?t(this.componentInstance,this._b({ref:"pageInstance",tag:"component"},"component",this.propsToBind,!1)):this._e()],1)],1)},staticRenderFns:[]},void 0,{methods:{emitBeforeRouteLeave:function(e,t,n){this.$refs.pageInstance.$options.beforeRouteLeave(e,t,n)},emitbeforeRouteEnter:function(e,t){var n=this,o=function(){n.updateComponent()};this.componentInstance.beforeRouteEnter?this.componentInstance.beforeRouteEnter(e,t,o):o()},destroyPage:function(){this.$refs.pageInstance&&this.$refs.pageInstance.$destroy()},updateComponent:function(){var e=this;this.resolveComponent(this.component).then((function(t){e.destroyPage();var n=t.default;e.componentInstance=n,null!=e.componentInstance.layout&&(e.layout=e.componentInstance.layout),e.componentInstance.props&&(e.propsToBind={},Array.isArray(e.componentInstance.props)?e.componentInstance.props.forEach((function(t){e.propsToBind[t]=e.data[t]})):Object.keys(e.componentInstance.props).forEach((function(t){e.propsToBind[t]=e.data[t]}))),e.$forceUpdate(),e.ready=!0}))}},data:function(){return{loading:!0,propsToBind:{},component:null,componentInstance:null,layout:m,ready:!1,data:{}}},created:function(){var e=this;axios.post("/ternobo-wire/get-data/"+this.dataToken).then((function(t){var n=t.data;e.data=n.data,e.component=n.component,e.$store.commit("updateShared",n.shared),e.$nextTick((function(){e.updateComponent()})),e.loading=!1,e.$store.dispatch("loadUser"),e.$store.commit("setupApp",{data:e.data,component:e.component,app:e})}))},props:["dataToken","resolveComponent"]},void 0,!1,void 0,!1,void 0,void 0,void 0),w={beforeRouteEnter:function(e,t,n){n()},beforeRouteLeave:function(e,t,n){n()}};function g(e){var t=window.location,n=document.createElement("a");return n.href=e,n.hostname==t.hostname&&n.port==t.port&&n.protocol==t.protocol}var b=function(){function e(t,n,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.data=o,window.history.replaceState(this.createVisitId({component:n,data:o}),"",window.location.href),window.addEventListener("popstate",(function(e){var t=e.state;"wire"==t.visitId&&(window.scrollTo(0,0),window.history.replaceState(e.state,"",window.location.href),a.loadComponent(window.location.pathname,e.target.location.pathname,t.data.component,t.data.data))}))}return i(e,null,[{key:"getInstance",value:function(e){return e.$store.state.ternoboWireApp}}]),i(e,[{key:"getData",value:function(t){var n=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get";return new Promise((function(s,d){var c=new CustomEvent("ternobo:navigate",{detail:{location:t}});o&&window.document.dispatchEvent(c),axios({method:r,data:i,url:t,headers:{"X-TernoboWire":!0}}).then((function(e){if(s(e.data.data),e.headers["x-ternobowire"]){a&&window.history.pushState(n.createVisitId(e.data),"",t);var i=new CustomEvent("ternobo:loaded",{detail:{location:t}});o&&window.document.dispatchEvent(i)}})).catch((function(t){e.production||console.log(t),d(t)})).then((function(){if(o){var e=new CustomEvent("ternobo:finish",{detail:{location:t}});window.document.dispatchEvent(e)}s()}))}))}},{key:"reload",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=window.location.href,a=new CustomEvent("ternobo:navigate",{detail:{location:o}});window.document.dispatchEvent(a),axios({method:"GET",data:{options:n},url:o,headers:{"X-ReloadData":!0,"X-TernoboWire":!0}}).then((function(e){if(e.headers["x-ternobowire"]){t.app.$store.commit("updateShared",e.data.shared),t.loadComponent(window.location.pathname,window.location.pathname,e.data.component,e.data.data);var n=new CustomEvent("ternobo:loaded",{detail:{location:o}});window.document.dispatchEvent(n)}else window.location.reload()})).catch((function(t){e.production||console.log(t)})).then((function(){var e=new CustomEvent("ternobo:finish",{detail:{location:o}});window.document.dispatchEvent(e)}))}},{key:"visit",value:function(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.app.emitBeforeRouteLeave(window.location.pathname,t,(function(){g(t)||window.open(t);var r=new CustomEvent("ternobo:navigate",{detail:{location:t}});window.document.dispatchEvent(r),axios({method:a,data:o,url:t,headers:{"X-TernoboWire":!0}}).then((function(e){if(e.headers["x-ternobowire"]){n.app.$store.commit("updateShared",e.data.shared),n.loadComponent(window.location.pathname,t,e.data.component,e.data.data),i&&window.history.pushState(n.createVisitId(e.data),"",t);var o=new CustomEvent("ternobo:loaded",{detail:{location:t}});window.document.dispatchEvent(o)}else window.location=t})).catch((function(t){e.production||console.log(t)})).then((function(){var e=new CustomEvent("ternobo:finish",{detail:{location:t}});window.document.dispatchEvent(e)}))}))}},{key:"loadComponent",value:function(e,t,n,o){this.app.component=n,this.app.data=o,this.app.emitbeforeRouteEnter(t,e)}},{key:"createVisitId",value:function(e){return this.visitId={data:e,visitId:"wire"},this.visitId}}]),e}(),y={install:function(e){e.use(o.default),e.mixin(w),e.component("wire-link",c),e.directive("t-infinite-scroll",{bind:function(e,t,n){e.addEventListener("scroll",(function(n){e.scrollTop+e.clientHeight>=e.scrollHeight&&t.value()}))}}),e.directive("click-outside",{bind:function(e,t,n){document.body.addEventListener("click",(function(e){return n.context.$emit(t.expression,e)}))}})}};return e.TernoboWire=b,e.default=v,e.plugin=y,e.store=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{state:{},actions:{},mutations:{}},t=d(d({},e),{},{state:d(d({},e.state),{},{user:{},ternoboWireApp:null,shared:{}}),actions:d(d({},e.actions),{},{loadUser:function(e){axios.post("/ternobo-wire/get-user").then((function(t){e.commit("setUser",t.data.user);var n=new CustomEvent("ternobo:userloaded",{detail:{user:t.data.user}});window.document.dispatchEvent(n)}))},loadShared:function(e){axios.post("/ternobo-wire/get-shared").then((function(t){e.commit("updateShared",t.data.shared);var n=new CustomEvent("ternobo:sharedataloaded",{detail:{user:t.data.user}});window.document.dispatchEvent(n)}))}}),mutations:d(d({},e.mutations),{},{setUser:function(e,t){e.user=t},setupApp:function(e,t){e.ternoboWireApp=new b(t.app,t.component,t.data)},updateShared:function(e,t){e.shared=t}})});return new o.default.Store(t)},Object.defineProperty(e,"__esModule",{value:!0}),e}({},Vuex);